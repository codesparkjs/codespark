---
title: File System
description: Learn how to manage multiple files in Codespark with a structured file system
---

import { File, Folder, Files } from 'fumadocs-ui/components/files';

Codespark provides a structured file system that supports multi-file previews.

## Quick Start

Suppose you want to create a file tree with the following structure:

<Files>
  <Folder name="components" defaultOpen>
    <File name="button.tsx" />
  </Folder>
  <File name="App.tsx" />
</Files>

You can define the `files` object according to the file hierarchy and pass it to the `Codespark` component:

```tsx preview="multi-files"
import { Codespark } from '@codespark/react';

const files = {
  './App.tsx': '...', // Entry point file
  './components/button.tsx': '...'
};

export default function App() {
  return <Codespark files={files} />;
}
```

```tsx codespark-preview
import { Codespark } from '@codespark/react';

const files = {
  './App.tsx': `import { Button } from './components/button';

export default function App() {
  return (
    <div className="flex justify-center">
      <Button />
    </div>
  );
}`,
  './components/button.tsx': `import confetti from 'https://esm.sh/canvas-confetti@1.6.0';

export function Button() {
  return (
    <button className="mx-auto cursor-pointer rounded-lg bg-gray-100 px-3 py-2 dark:bg-gray-700" onClick={() => confetti()}>
      Click Me
    </button>
  );
}`
};

export default function App() {
  return <Codespark files={files} />;
}
```

## Through Workspace

Creating and managing files through Workspace offers greater flexibility and control. You can create a multi-file system by specifying the entry file and files in the Workspace.

```tsx twoslash
import { CodesparkProvider, Workspace } from '@codespark/react';

const workspace = new Workspace({ entry: './App.tsx', files: { './App.tsx': '...' } });

// @noErrors
<CodesparkProvider workspace={workspace} />
```

## File Management

### File Tree Structure

The `useWorkspace` hook provides access to a hierarchical file tree representation:

```tsx
const { fileTree } = useWorkspace();

// Example fileTree structure:
[
  {
    type: 'file',
    name: 'App.tsx',
    path: './App.tsx',
    code: '...',
    language: 'typescript'
  },
  {
    type: 'folder',
    name: 'components',
    path: 'components',
    children: [
      {
        type: 'file',
        name: 'Button.tsx',
        path: 'components/Button.tsx',
        code: '...',
        language: 'typescript'
      }
    ]
  }
]
```

### Creating and Updating Files

```tsx
// Create or update a single file
workspace.setFile('./utils.ts', 'export const add = (a, b) => a + b;');

// Create or update multiple files simultaneously
workspace.setFiles({
  './App.tsx': '...',
  './utils.ts': '...',
  './styles.css': '...'
});
```

### Renaming Files

```tsx
// Rename a single file
workspace.renameFile('./utils.ts', 'helpers.ts');
// Result: ./helpers.ts

// Rename a folder (all nested files are automatically renamed)
workspace.renameFile('src/components', 'ui');
// Example: src/components/Button.tsx → ui/Button.tsx
```

### Deleting Files

```tsx
// Delete a file
workspace.deleteFile('./utils.ts');

// Delete a folder (all nested files are automatically deleted)
workspace.deleteFile('src/components');
```

### Setting Active File

```tsx
// Set the currently active file in the editor
workspace.setCurrentFile('./App.tsx');
```

## Interactive Demo

This demo showcases all file management operations. Click the buttons to see each operation in action.

```tsx codespark-preview height=538
import { CodesparkEditor, CodesparkFileExplorer, CodesparkProvider, useWorkspace } from '@codespark/react';
import { FilePlus, FileText, Pencil, RotateCcw, Trash2 } from 'lucide-react';
import { useEffect, useState } from 'react';

const defaultAppCode = `export default function App() {
  return <div className="p-4 text-center">Hello World</div>;
}`;

const initialFiles = {
  './App.tsx': defaultAppCode
};

function Console({ logs }: { logs: { type: string; message: string }[] }) {
  return (
    <div className="bg-muted/30 h-[140px] space-y-1.5 overflow-auto p-3 font-mono text-xs">
      {logs.length === 0 ? (
        <p className="text-muted-foreground">Waiting for events...</p>
      ) : (
        logs.map((log, i) => (
          <div key={i} className="flex gap-2">
            <span className="shrink-0 text-sky-500">[{log.type}]</span>
            <span className="text-foreground">{log.message}</span>
          </div>
        ))
      )}
    </div>
  );
}

function FileActions({ onReset }: { onReset: () => void }) {
  const { workspace } = useWorkspace();

  const createFile = () => {
    const name = `./file-${Date.now().toString().slice(-4)}.ts`;
    workspace.setFile(name, `export const value = ${Math.floor(Math.random() * 100)};`);
    workspace.setCurrentFile(name);
  };

  const updateCurrentFile = () => {
    const current = workspace.currentFile;
    if (current && current.path !== './App.tsx') {
      workspace.setFile(current.path, current.code + `\n// Updated`);
    }
  };

  const renameCurrentFile = () => {
    const current = workspace.currentFile;
    if (current && current.path !== './App.tsx') {
      const newName = `renamed-${Date.now().toString().slice(-4)}.ts`;
      workspace.renameFile(current.path, newName);
    }
  };

  const deleteCurrentFile = () => {
    const current = workspace.currentFile;
    if (current && current.path !== './App.tsx') {
      workspace.deleteFile(current.path);
      workspace.setCurrentFile('./App.tsx');
    }
  };

  const isEntryFile = workspace.currentFile?.path === './App.tsx';

  return (
    <div className="border-border flex flex-wrap gap-2 p-2">
      <button onClick={createFile} className="bg-muted hover:bg-muted/80 flex items-center gap-1.5 rounded-md px-2.5 py-1.5 text-xs font-medium">
        <FilePlus className="h-3.5 w-3.5" /> Create
      </button>
      <button onClick={updateCurrentFile} disabled={isEntryFile} className="bg-muted hover:bg-muted/80 flex items-center gap-1.5 rounded-md px-2.5 py-1.5 text-xs font-medium disabled:cursor-not-allowed disabled:opacity-50">
        <FileText className="h-3.5 w-3.5" /> Update
      </button>
      <button onClick={renameCurrentFile} disabled={isEntryFile} className="bg-muted hover:bg-muted/80 flex items-center gap-1.5 rounded-md px-2.5 py-1.5 text-xs font-medium disabled:cursor-not-allowed disabled:opacity-50">
        <Pencil className="h-3.5 w-3.5" /> Rename
      </button>
      <button onClick={deleteCurrentFile} disabled={isEntryFile} className="bg-muted hover:bg-muted/80 flex items-center gap-1.5 rounded-md px-2.5 py-1.5 text-xs font-medium disabled:cursor-not-allowed disabled:opacity-50">
        <Trash2 className="h-3.5 w-3.5" /> Delete
      </button>
      <div className="flex-1" />
      <button onClick={onReset} className="bg-muted hover:bg-muted/80 flex items-center gap-1.5 rounded-md px-2.5 py-1.5 text-xs font-medium">
        <RotateCcw className="h-3.5 w-3.5" /> Reset
      </button>
    </div>
  );
}

export default function App() {
  const { workspace, files } = useWorkspace({ entry: './App.tsx', files: initialFiles });
  const [logs, setLogs] = useState<{ type: string; message: string }[]>([]);

  const addLog = (type: string, message: string) => {
    setLogs(prev => [...prev, { type, message }].slice(-10));
  };

  useEffect(() => {
    const unsubscribes = [
      workspace.on('fileChange', (path, content) => {
        addLog('fileChange', `${path} (${content.length} chars)`);
      }),
      workspace.on('fileRename', (oldPath, newPath) => {
        addLog('fileRename', `${oldPath} → ${newPath}`);
      }),
      workspace.on('fileDelete', path => {
        addLog('fileDelete', path);
      }),
      workspace.on('currentFileChange', file => {
        addLog('currentFileChange', file.path);
      })
    ];
    return () => unsubscribes.forEach(fn => fn());
  }, [workspace]);

  const handleReset = () => {
    Object.keys(files).forEach(path => {
      if (path !== './App.tsx') workspace.deleteFile(path);
    });
    workspace.setFile('./App.tsx', defaultAppCode);
    workspace.setCurrentFile('./App.tsx');
    setTimeout(() => setLogs([]), 0);
  };

  return (
    <CodesparkProvider workspace={workspace}>
      <div className="border-border divide-y overflow-hidden rounded-xl border">
        <FileActions onReset={handleReset} />
        <div className="border-border flex">
          <CodesparkFileExplorer className="border-border max-h-[350px] w-40 overflow-auto border-r" />
          <CodesparkEditor containerProps={{ className: 'w-0 flex-1' }} height="350px" toolbox={false} />
        </div>
        <Console logs={logs} />
      </div>
    </CodesparkProvider>
  );
}
```
